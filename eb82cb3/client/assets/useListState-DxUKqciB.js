import{r as y}from"./chunk-QMGIS6GS-CFDD2jAw.js";import{z as k,U as M,V as m,W as w,X as C}from"./text-CLqYBJ6O.js";function z(l){const t=y.version.split(".");return parseInt(t[0],10)>=19?l:l?"true":void 0}function T(l,t){let e=t?.isDisabled,[i,u]=y.useState(!1);return k(()=>{if(l?.current&&!e){let a=()=>{if(l.current){let n=M(l.current,{tabbable:!0});u(!!n.nextNode())}};a();let r=new MutationObserver(a);return r.observe(l.current,{subtree:!0,childList:!0,attributes:!0,attributeFilter:["tabIndex","disabled"]}),()=>{r.disconnect()}}}),e?!1:i}class g{*[Symbol.iterator](){yield*this.iterable}get size(){return this._size}getKeys(){return this.keyMap.keys()}getKeyBefore(t){let e=this.keyMap.get(t);var i;return e&&(i=e.prevKey)!==null&&i!==void 0?i:null}getKeyAfter(t){let e=this.keyMap.get(t);var i;return e&&(i=e.nextKey)!==null&&i!==void 0?i:null}getFirstKey(){return this.firstKey}getLastKey(){return this.lastKey}getItem(t){var e;return(e=this.keyMap.get(t))!==null&&e!==void 0?e:null}at(t){const e=[...this.getKeys()];return this.getItem(e[t])}getChildren(t){let e=this.keyMap.get(t);return e?.childNodes||[]}constructor(t){this.keyMap=new Map,this.firstKey=null,this.lastKey=null,this.iterable=t;let e=n=>{if(this.keyMap.set(n.key,n),n.childNodes&&n.type==="section")for(let s of n.childNodes)e(s)};for(let n of t)e(n);let i=null,u=0,a=0;for(let[n,s]of this.keyMap)i?(i.nextKey=n,s.prevKey=i.key):(this.firstKey=n,s.prevKey=void 0),s.type==="item"&&(s.index=u++),(s.type==="section"||s.type==="item")&&a++,i=s,i.nextKey=void 0;this._size=a;var r;this.lastKey=(r=i?.key)!==null&&r!==void 0?r:null}}function V(l){let{filter:t,layoutDelegate:e}=l,i=m(l),u=y.useMemo(()=>l.disabledKeys?new Set(l.disabledKeys):new Set,[l.disabledKeys]),a=y.useCallback(b=>t?new g(t(b)):new g(b),[t]),r=y.useMemo(()=>({suppressTextValueWarning:l.suppressTextValueWarning}),[l.suppressTextValueWarning]),n=w(l,a,r),s=y.useMemo(()=>new C(n,i,{layoutDelegate:e}),[n,i,e]);return x(n,s),{collection:n,disabledKeys:u,selectionManager:s}}function W(l,t){let e=y.useMemo(()=>t?l.collection.filter(t):l.collection,[l.collection,t]),i=l.selectionManager.withCollection(e);return x(e,i),{collection:e,selectionManager:i,disabledKeys:l.disabledKeys}}function x(l,t){const e=y.useRef(null);y.useEffect(()=>{if(t.focusedKey!=null&&!l.getItem(t.focusedKey)&&e.current){const d=e.current.getItem(t.focusedKey),K=[...e.current.getKeys()].map(v=>{const c=e.current.getItem(v);return c?.type==="item"?c:null}).filter(v=>v!==null),o=[...l.getKeys()].map(v=>{const c=l.getItem(v);return c?.type==="item"?c:null}).filter(v=>v!==null);var i,u;const h=((i=K?.length)!==null&&i!==void 0?i:0)-((u=o?.length)!==null&&u!==void 0?u:0);var a,r,n;let f=Math.min(h>1?Math.max(((a=d?.index)!==null&&a!==void 0?a:0)-h+1,0):(r=d?.index)!==null&&r!==void 0?r:0,((n=o?.length)!==null&&n!==void 0?n:0)-1),$=null,p=!1;for(;f>=0;){if(!t.isDisabled(o[f].key)){$=o[f];break}if(f<o.length-1&&!p)f++;else{p=!0;var s,b;f>((s=d?.index)!==null&&s!==void 0?s:0)&&(f=(b=d?.index)!==null&&b!==void 0?b:0),f--}}t.setFocusedKey($?$.key:null)}e.current=l},[l,t])}export{V as $,W as a,z as b,T as c,g as d};
//# sourceMappingURL=useListState-DxUKqciB.js.map
