import{e as O,b as R,c as E,Q as M,d as Q}from"./useQuery-BQpwwpuc.js";function w(t){return{onFetch:(e,r)=>{const a=e.options,u=e.fetchOptions?.meta?.fetchMore?.direction,g=e.state.data?.pages||[],h=e.state.data?.pageParams||[];let o={pages:[],pageParams:[]},i=0;const P=async()=>{let c=!1;const l=s=>{Object.defineProperty(s,"signal",{enumerable:!0,get:()=>(e.signal.aborted?c=!0:e.signal.addEventListener("abort",()=>{c=!0}),e.signal)})},d=O(e.options,e.fetchOptions),m=async(s,n,f)=>{if(c)return Promise.reject();if(n==null&&s.pages.length)return Promise.resolve(s);const p={queryKey:e.queryKey,pageParam:n,direction:f?"backward":"forward",meta:e.options.meta};l(p);const N=await d(p),{maxPages:b}=e.options,y=f?R:E;return{pages:y(s.pages,N,b),pageParams:y(s.pageParams,n,b)}};if(u&&g.length){const s=u==="backward",n=s?F:v,f={pages:g,pageParams:h},p=n(a,f);o=await m(f,p,s)}else{const s=t??g.length;do{const n=i===0?h[0]??a.initialPageParam:v(a,o);if(i>0&&n==null)break;o=await m(o,n),i++}while(i<s)}return o};e.options.persister?e.fetchFn=()=>e.options.persister?.(P,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},r):e.fetchFn=P}}}function v(t,{pages:e,pageParams:r}){const a=e.length-1;return e.length>0?t.getNextPageParam(e[a],e,r[a],r):void 0}function F(t,{pages:e,pageParams:r}){return e.length>0?t.getPreviousPageParam?.(e[0],e,r[0],r):void 0}function k(t,e){return e?v(t,e)!=null:!1}function q(t,e){return!e||!t.getPreviousPageParam?!1:F(t,e)!=null}var K=class extends M{constructor(t,e){super(t,e)}bindMethods(){super.bindMethods(),this.fetchNextPage=this.fetchNextPage.bind(this),this.fetchPreviousPage=this.fetchPreviousPage.bind(this)}setOptions(t,e){super.setOptions({...t,behavior:w()},e)}getOptimisticResult(t){return t.behavior=w(),super.getOptimisticResult(t)}fetchNextPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"forward"}}})}fetchPreviousPage(t){return this.fetch({...t,meta:{fetchMore:{direction:"backward"}}})}createResult(t,e){const{state:r}=t,a=super.createResult(t,e),{isFetching:u,isRefetching:g,isError:h,isRefetchError:o}=a,i=r.fetchMeta?.fetchMore?.direction,P=h&&i==="forward",c=u&&i==="forward",l=h&&i==="backward",d=u&&i==="backward";return{...a,fetchNextPage:this.fetchNextPage,fetchPreviousPage:this.fetchPreviousPage,hasNextPage:k(e,r.data),hasPreviousPage:q(e,r.data),isFetchNextPageError:P,isFetchingNextPage:c,isFetchPreviousPageError:l,isFetchingPreviousPage:d,isRefetchError:o&&!P&&!l,isRefetching:g&&!c&&!d}}};function T(t,e){return Q(t,K,e)}export{w as i,T as u};
//# sourceMappingURL=useInfiniteQuery-DHZtFi9U.js.map
