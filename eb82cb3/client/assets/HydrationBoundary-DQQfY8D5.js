import{r as p}from"./chunk-QMGIS6GS-CFDD2jAw.js";import{a as Q}from"./useQuery-BQpwwpuc.js";function A(t){return t}function m(t,o,r){if(typeof o!="object"||o===null)return;const q=t.getMutationCache(),s=t.getQueryCache(),u=r?.defaultOptions?.deserializeData??t.getDefaultOptions().hydrate?.deserializeData??A,y=o.mutations||[],f=o.queries||[];y.forEach(({state:c,...a})=>{q.build(t,{...t.getDefaultOptions().hydrate?.mutations,...r?.defaultOptions?.mutations,...a},c)}),f.forEach(({queryKey:c,state:a,queryHash:n,meta:d,promise:e})=>{let i=s.get(n);const l=a.data===void 0?a.data:u(a.data);if(i){if(i.state.dataUpdatedAt<a.dataUpdatedAt){const{fetchStatus:h,...g}=a;i.setState({...g,data:l})}}else i=s.build(t,{...t.getDefaultOptions().hydrate?.queries,...r?.defaultOptions?.queries,queryKey:c,queryHash:n,meta:d},{...a,data:l,fetchStatus:"idle"});if(e){const h=Promise.resolve(e).then(u);i.fetch(void 0,{initialPromise:h})}})}var O=({children:t,options:o={},state:r,queryClient:q})=>{const s=Q(q),[u,y]=p.useState(),f=p.useRef(o);return f.current=o,p.useMemo(()=>{if(r){if(typeof r!="object")return;const c=s.getQueryCache(),a=r.queries||[],n=[],d=[];for(const e of a){const i=c.get(e.queryHash);if(!i)n.push(e);else{const l=e.state.dataUpdatedAt>i.state.dataUpdatedAt,h=u?.find(g=>g.queryHash===e.queryHash);l&&(!h||e.state.dataUpdatedAt>h.state.dataUpdatedAt)&&d.push(e)}}n.length>0&&m(s,{queries:n},f.current),d.length>0&&y(e=>e?[...e,...d]:d)}},[s,u,r]),p.useEffect(()=>{u&&(m(s,{queries:u},f.current),y(void 0))},[s,u]),t};export{O as H};
//# sourceMappingURL=HydrationBoundary-DQQfY8D5.js.map
