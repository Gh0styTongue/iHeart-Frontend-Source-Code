import{j as u,a as E}from"./create-logger-DNtzi1_a.js";import{r as w,c as P,h as v}from"./text-CLqYBJ6O.js";import{r}from"./chunk-QMGIS6GS-CFDD2jAw.js";import{l as m}from"./http-error-DJhpcL-Y.js";import{f as D,k as N}from"./amp-client-C2ZZL0mA.js";import{p as x,S as k,b as y}from"./use-item-selected-BbUZv3TT.js";import{h as L,C as U,D as T}from"./default-DN-ti_cn.js";import{a as z,u as O,b as W,c as q,d as B,e as Z,f as $,g as G,h as H,C,i as K,r as M}from"./use-display-ad-BA-nEzAS.js";var Q="m1j9jq0",F="m1j9jq1";function J({width:c,height:t,children:n,...a},e){const{className:d,style:i}=w({width:c,height:t});return u.jsx("div",{className:P(Q,d),ref:e,style:i,...a,children:n})}function V({children:c,isGrid:t=!1,...n},a){return u.jsx("div",{className:F,"data-grid":t,ref:a,...n,children:c})}const X=r.forwardRef(J),Y=r.forwardRef(V),A=[320,50],S=[728,90];function ct(c){const t=E.c(5),{isGrid:n}=c,a=n===void 0?!1:n,e=D(v.medium),{display:d}=O(!0),{enabled:i}=W();let l;return t[0]!==d||t[1]!==i||t[2]!==a||t[3]!==e?(l=i?u.jsx(tt,{display:d,displayAdsEnabled:i,isGrid:a,isMedium:e}):null,t[0]=d,t[1]=i,t[2]=a,t[3]=e,t[4]=l):l=t[4],l}function tt({isGrid:c,isMedium:t,display:n,displayAdsEnabled:a}){q();const e=B({ccrpos:C.Inline}),d=x.useAds(),{station:i,status:l}=x.useState(),f=r.useMemo(()=>!(i.type===k.Scan&&[y.Playing,y.Buffering,y.Restart].includes(l)),[i.type,l]),[s,p]=r.useReducer(Z,{display:n,displayAdsEnabled:a},$),g=G(),h=r.useRef(null);r.useEffect(()=>{if(m(e)){const o={adUnitPath:e,targeting:g,size:t?S:A};s.display==="ad"&&!N(o,h.current)&&f&&(h.current={...o},setTimeout(()=>{p({type:"set_slot",payload:{...o,ccrpos:C.Inline,slotId:H(4)}})},0))}},[e,s.display,g,t,f]),r.useEffect(()=>{if(m(s.slot)){const{slotId:o,adUnitPath:j,targeting:_,ccrpos:b,size:R}=s.slot;return K({adUnitPath:j,targeting:_,ccrpos:b,size:R,slotId:o}),()=>{M(o)}}},[s.slot]),r.useEffect(()=>{const o=new AbortController;return window.focus(),window.addEventListener("blur",L({containerId:s.slot?.slotId}),{signal:o.signal}),()=>{o.abort()}},[s.slot?.slotId]);const I=r.useMemo(()=>d.current?.companions?.find(o=>t?o.height===S[1]&&o.width===S[0]:o.height===A[1]&&o.width===A[0])??null,[d,t]);return r.useEffect(()=>{m(I)?p({type:"set_companion",payload:u.jsx(U,{companion:I})}):m(s.companionAd)&&p({type:"set_companion",payload:null})},[I,s.companionAd]),r.useMemo(()=>u.jsx(Y,{isGrid:c,children:u.jsxs(nt,{isCompanion:s.display==="companion",slotId:s.slot?.slotId,children:[u.jsx(T,{isMedium:t}),s.companionAd]})},s.slot?.slotId),[s.companionAd,s.display,s.slot?.slotId,c,t])}const nt=r.memo(function(t){const n=E.c(6),{children:a,isCompanion:e,slotId:d}=t,i=e?"inline-ad-companion":"inline-ad-slot",l=e?"companion":"ad",f=e?"inline-companion":d,s=e?void 0:z;let p;return n[0]!==a||n[1]!==i||n[2]!==l||n[3]!==f||n[4]!==s?(p=u.jsx(X,{"data-test":i,"data-type":l,id:f,onClick:s,children:a}),n[0]=a,n[1]=i,n[2]=l,n[3]=f,n[4]=s,n[5]=p):p=n[5],p});export{ct as I};
//# sourceMappingURL=inline-ad-CQB5Gb6c.js.map
