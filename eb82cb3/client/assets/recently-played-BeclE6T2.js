import{S as e,e as R,u as I,m as g}from"./amp-client-C2ZZL0mA.js";import{u as C,a as L,k as E}from"./useQuery-BQpwwpuc.js";import{u as D}from"./useMutation--G9MfniU.js";import{r as S}from"./chunk-QMGIS6GS-CFDD2jAw.js";import{s as u,p as P}from"./slugify-CmQ1Aov3.js";import{l as v}from"./http-error-DJhpcL-Y.js";import{j as p}from"./create-logger-DNtzi1_a.js";import{l as m}from"./text-CLqYBJ6O.js";import{M as b}from"./microphone-Cz4Tgd9R.js";import{P as V}from"./playlist-SwzaceOD.js";import{R as N}from"./radio-BUbdRu0J.js";import{S as F}from"./search-BRZBnbKH.js";import{u as q}from"./play-BQDnmloD.js";import{l as x}from"./use-apps-flyer-CIIIQYDX.js";const _={playlists_directory:{editable:!1,common:{title:"Recently Played Playlists",titleSlug:u("Recently Played Playlists"),stationTypes:[e.COLLECTION]},states:{anon:{description:"Log in for free to save your listening history and more.",logo:null},auth:{description:"Listen to a playlist and you'll find your history here.",logo:p.jsx(V,{color:m("$red550","$red300"),size:32})}}},radio_directory:{editable:!1,common:{title:"Recently Played Stations",titleSlug:u("Recently Played Stations"),stationTypes:[e.RADIO,e.LIVE]},states:{anon:{description:"Log in for free to save your listening history and more.",logo:null},auth:{description:"Listen to radio and you'll find your history here.",logo:p.jsx(N,{color:m("$red550","$red300"),size:32})}}},podcasts_directory:{editable:!1,common:{title:"Recently Played Podcasts",titleSlug:u("Recently Played Podcasts"),stationTypes:[e.PODCAST]},states:{anon:{description:"Log in for free to save your listening history and more.",logo:null},auth:{description:"Listen to podcasts and you'll find your history here.",logo:p.jsx(b,{color:m("$red550","$red300"),size:32})}}},home:{editable:!0,common:{title:"Recently Played",titleSlug:u("Recently Played"),stationTypes:[e.ARTIST,e.COLLECTION,e.FAVORITES,e.LIVE,e.PODCAST,e.RADIO]},states:{anon:{description:"Log in for free to save your listening history and more.",logo:null},auth:{description:"Listen to live radio, artists, podcasts and playlists to see your listening history.",logo:p.jsx(F,{color:m("$red550","$red300"),size:32})}}}},$="playlist_collections",f={all:["recently-played-stations"],byType:a=>[...f.all,a.join("|")]};async function A({amp:a,includePlaylists:t=!0,isPagination:o=!1,pages:s=1,profileId:i,stationsPerPage:n=35,stationTypes:l=[e.ARTIST,e.COLLECTION,e.FAVORITES,e.LIVE,e.PODCAST,e.RADIO],time:r}){const y=async()=>a.api.v2.playlists.getStations({params:{profileId:i},query:{campaignId:t?$:void 0,includePersonalized:!0,sortBy:"LAST_PLAYED",...o?{limit:n,offset:n*(s-1)}:{limit:n*s,offset:0},stationTypes:l}}).then(P("body")).then(P("hits")).catch(c=>(x.error(c instanceof Error?c.message:JSON.stringify(c)),[]))??[];return v(r)?r("recently-played",y):y()}async function j({amp:a,profileId:t,queryClient:o,stationTypes:s=[e.ARTIST,e.COLLECTION,e.FAVORITES,e.LIVE,e.PODCAST,e.RADIO],...i}){await o.prefetchQuery({queryKey:f.byType(s),queryFn:()=>A({amp:a,profileId:t,stationTypes:s,...i}),staleTime:g("30s")})}function Z(){const a=R(),t=L(),{profileId:o}=I()??{};return async s=>{const{stationTypes:i,...n}=s??{stationTypes:[e.ARTIST,e.COLLECTION,e.FAVORITES,e.LIVE,e.PODCAST,e.RADIO]};await j({amp:a,profileId:o,queryClient:t,stationTypes:i,...n})}}function ee({stationTypes:a=[e.ARTIST,e.COLLECTION,e.FAVORITES,e.LIVE,e.PODCAST,e.RADIO],enabled:t=!0,...o}){const s=R(),{profileId:i}=I()??{};return C({enabled:t,queryKey:f.byType(a),queryFn:()=>A({amp:s,profileId:i,stationTypes:a,...o}),staleTime:g("0"),placeholderData:E})}function te(a){const t=R(),{profileId:o,sessionId:s}=I()??{},i=L(),n=q(),{onSuccess:l}={},r=S.useCallback(async({stationType:d,playedFrom:O,contentId:T})=>{const{status:h}=await t.api.v2.playlists.postAddStation({params:{type:d,profileId:o,contentId:T},body:{addToFavorites:!1,playedFrom:O,contentId:T}});d===e.LIVE&&h===200&&await t.api.v1.liveRadio.postRegisterListen({params:{profileId:String(o),stationId:String(T)},body:{profileId:o,sessionId:s}})},[t.api.v1.liveRadio,t.api.v2.playlists,o,s]),y=S.useCallback(()=>{const{stationTypes:d}=_[n].common;i.invalidateQueries({queryKey:f.byType(d)}),l?.()},[l,n,i]);return{addToRecentlyPlayed:D({mutationFn:r,onSuccess:y}).mutateAsync}}export{_ as R,Z as a,te as b,ee as u};
//# sourceMappingURL=recently-played-BeclE6T2.js.map
