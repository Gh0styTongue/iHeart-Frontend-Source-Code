import{a as R,j as h}from"./create-logger-DNtzi1_a.js";import{T as ie,F as U}from"./text-CLqYBJ6O.js";import{S as V,a as W}from"./select-field-D0C0OudW.js";import{b as z}from"./create-analytics-DYSkN0SF.js";import{l as H,b as D}from"./http-error-DJhpcL-Y.js";import{m as re,g as J,u as ae,t as X}from"./amp-client-C2ZZL0mA.js";import{u as ce,S as k}from"./use-item-selected-BbUZv3TT.js";import{u as de,e as F,r as N}from"./chunk-QMGIS6GS-CFDD2jAw.js";import{$ as me}from"./index-B6aK0ntB.js";import{t as Z}from"./track-click-bvirfrjt.js";import{C as ue,a as fe}from"./card-carousel-CZ58soqk.js";import{a as pe}from"./content-card-CR0n9yPy.js";import{R as ye}from"./ranked-content-card-CfhjQS7V.js";import{m as ge,h as Se,A as he}from"./request-info-Bv3SWXDS.js";import{u as Pe}from"./is-mobile-BqLxbqHZ.js";import{P as q}from"./index-DKKUGGYL.js";import{u as _e}from"./useQuery-BQpwwpuc.js";import{u as Te}from"./webapi-client-DOa4NTc_.js";import{l as ee}from"./use-apps-flyer-CIIIQYDX.js";import{P as B,a as Q}from"./constants-Culc7LLS.js";import{m as be}from"./get-playlist-profile-slug-D7zzoeNX.js";import{i as xe}from"./play-DDtWrYBn.js";async function Ce({country:i,locale:e,time:s,webapiClient:t,signal:n}){const c=async()=>{try{const{directories:r}=(await t.request(t.queries.playlistDirectoriesMoodsGenres({countryCode:i,locale:e}),{signal:n})).playlists,g=r.genres.items[0].children?.reduce((m,l)=>{const a=l?.tags?.find(o=>o.includes(B))?.replace(B,"");if(a&&l){const o=l.metadata.find(y=>y.locales.find(p=>p.includes(e)));m[a]={tags:l.tags??[],title:String(o?.title)}}return m},{});if(g===void 0)throw new Error('There are no "genres" that exist for this query.');const d=r.moods.items[0].children?.reduce((m,l)=>{const a=l?.tags?.find(o=>o.includes(Q))?.replace(Q,"");if(a&&l){const o=l.metadata.find(y=>y.locales.find(p=>p.includes(e)));m[a]={tags:l.tags??[],title:String(o?.title)}}return m},{});if(d===void 0)throw new Error('There are no "moods" that exist for this query.');return{genres:g,moods:d}}catch(r){return ee.error(r?.message,{error:r}),{genres:{},moods:{}}}};return H(s)?s("playlist-genres-and-moods",c):c()}const j="all",G="all",te="playlist-genre",se="playlist-mood",Ie="rankers-top-playlists";async function Ae({country:i=J.Enum.US,genre:e,locale:s,mood:t,time:n,webapiClient:c,signal:r}){const g=async()=>{try{const{genres:d,moods:f}=await Ce({country:i,locale:s,time:n,webapiClient:c,signal:r}),{children:m=[]}=(await c.request(c.queries.playlistDirectoriesItems({countryCode:i,locale:s,tags:[...new Set([...d?.[e]?.tags??[],...f?.[t]?.tags??[]])]}),{signal:r}))?.playlists?.directories?.list?.items?.[0]??{},l=m?.filter(o=>o?.resource?.title)?.slice(0,10)?.map(o=>({...o?.resource,id:String(o?.id),title:String(o?.resource?.title)}));if(l===void 0)throw new Error('There are no "playlists" that exist for this query.');return{data:l,genre:e,genres:d,mood:t,moods:f}}catch(d){return ee.error(d?.message,{error:d}),{data:[],genre:G,genres:{},mood:j,moods:{}}}};return n===void 0?g():n(Ie,g)}function Ee({country:i=J.Enum.US,genre:e=G,locale:s="en-US",mood:t=j,time:n}){const c=Te();return _e({placeholderData:r=>r,queryKey:[i,s,e,t],queryFn:({signal:r})=>Ae({country:i,genre:e,locale:s,mood:t,time:n,webapiClient:c,signal:r}),staleTime:re("30m")})}const Y="Top Playlists",Le="byPlaylistGenre",Oe="byPlaylistMood",ve="All Genres",je="All Moods",le={width:"auto",maxWidth:{xsmall:"10.6rem",small:"12rem",medium:"18rem"}};function Ge(i){const e=R.c(17),{currentPlaylistGenre:s,genres:t,onSelectionChange:n,pageName:c,stateKey:r}=i,[,g]=F(),[d,f]=N.useState(!1);let m;e[0]!==s||e[1]!==t||e[2]!==c||e[3]!==n||e[4]!==g||e[5]!==r?(m=u=>{if(!D(u)&&X(u)&&u!==s?.toString()){const _=t[u]?.title??ve;Z({pageName:c,sectionName:z(Y),filterType:"genre",filterSelection:_,location:"filter"}),g(P=>(P.set(te,u.toString()),P),{replace:!0,preventScrollReset:!0,state:{stateKey:r}}),n(u)}},e[0]=s,e[1]=t,e[2]=c,e[3]=n,e[4]=g,e[5]=r,e[6]=m):m=e[6];const l=m;let a;e[7]===Symbol.for("react.memo_cache_sentinel")?(a={key:G,label:"All Genres",value:G},e[7]=a):a=e[7];let o;e[8]!==t?(o=[a,...Object.entries(t).map(Me)],e[8]=t,e[9]=o):o=e[9];const y=`GenreSelect-${s?.toString()}`;let p;e[10]===Symbol.for("react.memo_cache_sentinel")?(p=()=>f(!1),e[10]=p):p=e[10];let S;return e[11]!==s||e[12]!==d||e[13]!==l||e[14]!==o||e[15]!==y?(S=h.jsx(V,{"aria-label":"playlist genres select field",css:le,"data-test":"playlist-genres",defaultSelectedKey:s,isOpen:d,items:o,name:"playlistGenres",onBlur:p,onOpenChange:f,onSelectionChange:l,children:$e},y),e[11]=s,e[12]=d,e[13]=l,e[14]=o,e[15]=y,e[16]=S):S=e[16],S}function $e(i){return h.jsx(W,{textValue:i.label,children:i.label},i.key)}function Me(i){const[e,s]=i;return{key:e.toString(),label:s.title,value:e}}function Ne(i){const e=R.c(17),{currentPlaylistMood:s,moods:t,onSelectionChange:n,pageName:c}=i,[,r]=F(),[g,d]=N.useState(!1);let f;e[0]!==s||e[1]!==t||e[2]!==c||e[3]!==n||e[4]!==r?(f=u=>{if(!D(u)&&X(u)&&u!==s.toString()){const _=t&&!Array.isArray(t)?t[u]?.title??je:"";Z({pageName:c,sectionName:z(Y),filterType:"moods",filterSelection:_,location:"filter"}),r(P=>(P.set(se,u.toString()),P),{preventScrollReset:!0}),n(u)}},e[0]=s,e[1]=t,e[2]=c,e[3]=n,e[4]=r,e[5]=f):f=e[5];const m=f;let l;e[6]===Symbol.for("react.memo_cache_sentinel")?(l={key:j,label:"All Moods",value:j},e[6]=l):l=e[6];let a;e[7]!==t?(a=[l,...Object.entries(t??[]).map(Ye)],e[7]=t,e[8]=a):a=e[8];const o=`mood -${s?.toString()}`;let y,p;e[9]===Symbol.for("react.memo_cache_sentinel")?(y=()=>d(!1),p=u=>{d(u)},e[9]=y,e[10]=p):(y=e[9],p=e[10]);let S;return e[11]!==s||e[12]!==g||e[13]!==m||e[14]!==a||e[15]!==o?(S=h.jsx(V,{"aria-label":"playlist-moods",css:le,"data-test":"playlist-moods",defaultSelectedKey:s,isOpen:g,items:a,name:"playlistMoods",onBlur:y,onOpenChange:p,onSelectionChange:m,children:Re},o),e[11]=s,e[12]=g,e[13]=m,e[14]=a,e[15]=o,e[16]=S):S=e[16],S}function Re(i){return h.jsx(W,{textValue:i.label,children:i.label},i.key)}function Ye(i){const[e,s]=i;return{key:e??"",label:s?.title??"",value:e??""}}function we(i){const e=R.c(30),{pageName:s,playlist:t,index:n,sectionPosition:c}=i,{onItemSelected:r}=ce(),g=Pe(),d=ae();let f;e[0]!==d?(f=xe(d),e[0]=d,e[1]=f):f=e[1];const m=f,l=m?k.Playlist:k.PlaylistRadio;let a;e[2]!==s?(a={pageName:s,playedFrom:1005,eventLocation:Se.CAROUSEL,sectionName:Y},e[2]=s,e[3]=a):a=e[3];const o=a,y=`${Number(t?.publishedUserId)}::${t?.publishedPlaylistId}`;let p;e[4]!==o||e[5]!==y||e[6]!==l?(p={context:o,type:l,id:y},e[4]=o,e[5]=y,e[6]=l,e[7]=p):p=e[7];const{playing:S}=q.usePlaylistPlay(p),u=t?.title??"",_=t?.publishedUserId??"",P=t?.publishedPlaylistId??"";let T;e[8]!==u||e[9]!==_||e[10]!==P?(T=be({name:u,userId:_,id:P}),e[8]=u,e[9]=_,e[10]=P,e[11]=T):T=e[11];const b=T;let I;e[12]!==n||e[13]!==r||e[14]!==s||e[15]!==t?.publishedPlaylistId||e[16]!==t?.title||e[17]!==c||e[18]!==l?(I=()=>{r({pageName:s,section:"top_playlists",context:he.Carousel,itemPosition:n,sectionPosition:c,assets:{asset:{id:`${l}|${t?.publishedPlaylistId}`,name:t?.title??"",type:k.Playlist}}})},e[12]=n,e[13]=r,e[14]=s,e[15]=t?.publishedPlaylistId,e[16]=t?.title,e[17]=c,e[18]=l,e[19]=I):I=e[19];const x=I;let C;return e[20]!==o||e[21]!==n||e[22]!==g||e[23]!==x||e[24]!==S||e[25]!==t||e[26]!==b||e[27]!==l||e[28]!==m?(C=h.jsx(fe,{children:E=>{const{isFocused:$,isHovered:A}=E;return h.jsx(ye,{isFocused:$,isHovered:A,href:b?me("/playlist/:playlistSlug",{playlistSlug:b}):void 0,image:h.jsx(pe,{alt:t?.title??"",decoding:"auto",index:n,src:t?.urlImage||void 0,width:g?75:150}),imageButton:m?h.jsx(q.Playlist,{context:o,goToNowPlaying:"onPlay",id:`${Number(t?.publishedUserId)}::${t?.publishedPlaylistId}`,name:t.title,onPress:x,playlistSlug:b,shuffle:!1,size:48,type:l}):null,isActive:S,linesForTitle:2,onNavigation:x,rank:n+1,title:t?.title??""})}}),e[20]=o,e[21]=n,e[22]=g,e[23]=x,e[24]=S,e[25]=t,e[26]=b,e[27]=l,e[28]=m,e[29]=C):C=e[29],C}const at=i=>{const e=R.c(34),{sectionPosition:s}=i,{pageName:t}=de(),[n]=F();let c;e[0]!==n?(c=n.get(te)??G,e[0]=n,e[1]=c):c=e[1];const[r,g]=N.useState(c);let d;e[2]!==n?(d=n.get(se)??j,e[2]=n,e[3]=d):d=e[3];const[f,m]=N.useState(d),l=ge();let a;e[4]!==l.environment.countryCode||e[5]!==l.environment.locale||e[6]!==r||e[7]!==f?(a={country:l.environment.countryCode,locale:l.environment.locale,genre:r,mood:f},e[4]=l.environment.countryCode,e[5]=l.environment.locale,e[6]=r,e[7]=f,e[8]=a):a=e[8];const{data:o,isFetching:y}=Ee(a);if(D(o))return null;const{data:p,genre:S,genres:u,mood:_,moods:P}=o;let T;e[9]!==p?(T=p.filter(H).map(ke),e[9]=p,e[10]=T):T=e[10];const b=T,I=`top_playlist_${f}_${r}`;let x,C;e[11]===Symbol.for("react.memo_cache_sentinel")?(x={mobile:"space-between",large:"flex-start"},C={small:"$8",pointerCoarse:"$0"},e[11]=x,e[12]=C):(x=e[11],C=e[12]);let E;e[13]===Symbol.for("react.memo_cache_sentinel")?(E=h.jsx(ie,{as:"h3",kind:{mobile:"h4",large:"h3"},children:Y}),e[13]=E):E=e[13];const $=_??j;let A;e[14]!==P||e[15]!==t||e[16]!==$?(A=h.jsx(Ne,{currentPlaylistMood:$,moods:P,onSelectionChange:m,pageName:t,stateKey:Oe}),e[14]=P,e[15]=t,e[16]=$,e[17]=A):A=e[17];const w=S??G;let L;e[18]!==u||e[19]!==t||e[20]!==w?(L=h.jsx(Ge,{currentPlaylistGenre:w,genres:u,onSelectionChange:g,pageName:t,stateKey:Le}),e[18]=u,e[19]=t,e[20]=w,e[21]=L):L=e[21];let O;e[22]!==A||e[23]!==L?(O=h.jsxs(U,{alignItems:"center",gap:"$8",justifyContent:x,paddingRight:C,width:"100%",children:[E,h.jsxs(U,{gap:"$4",children:[A,L]})]}),e[22]=A,e[23]=L,e[24]=O):O=e[24];let v;e[25]!==t||e[26]!==s?(v=oe=>{const{index:ne,...K}=oe;return h.jsx(we,{index:ne,pageName:t,playlist:K,sectionPosition:s},K.publishedPlaylistId)},e[25]=t,e[26]=s,e[27]=v):v=e[27];let M;return e[28]!==y||e[29]!==b||e[30]!==O||e[31]!==v||e[32]!==I?(M=h.jsx(ue,{isLoading:y,items:b,kind:"ranker",title:O,children:v},I),e[28]=y,e[29]=b,e[30]=O,e[31]=v,e[32]=I,e[33]=M):M=e[33],M};function ke(i,e){return{...i,index:e}}export{at as T};
//# sourceMappingURL=top-playlists-carousel-CJZBATAu.js.map
