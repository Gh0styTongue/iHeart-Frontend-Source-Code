import{x as O,y as w,g as T,z as U,A as I,C as j}from"./text-CLqYBJ6O.js";import{r as d}from"./chunk-QMGIS6GS-CFDD2jAw.js";function J(a){let{description:e,errorMessage:t,isInvalid:r,validationState:s}=a,{labelProps:l,fieldProps:c}=O(a),v=w([!!e,!!t,r,s]),u=w([!!e,!!t,r,s]);return c=T(c,{"aria-describedby":[v,u,a["aria-describedby"]].filter(Boolean).join(" ")||void 0}),{labelProps:l,fieldProps:c,descriptionProps:{id:v},errorMessageProps:{id:u}}}const D={badInput:!1,customError:!1,patternMismatch:!1,rangeOverflow:!1,rangeUnderflow:!1,stepMismatch:!1,tooLong:!1,tooShort:!1,typeMismatch:!1,valueMissing:!1,valid:!0},P={...D,customError:!0,valid:!1},m={isInvalid:!1,validationDetails:D,validationErrors:[]},F=d.createContext({}),L="__formValidationState"+Date.now();function K(a){if(a[L]){let{realtimeValidation:e,displayValidation:t,updateValidation:r,resetValidation:s,commitValidation:l}=a[L];return{realtimeValidation:e,displayValidation:t,updateValidation:r,resetValidation:s,commitValidation:l}}return Q(a)}function Q(a){let{isInvalid:e,validationState:t,name:r,value:s,builtinValidation:l,validate:c,validationBehavior:v="aria"}=a;t&&(e||(e=t==="invalid"));let u=e!==void 0?{isInvalid:e,validationErrors:[],validationDetails:P}:null,n=d.useMemo(()=>{if(!c||s==null)return null;let o=_(c,s);return C(o)},[c,s]);l?.validationDetails.valid&&(l=void 0);let i=d.useContext(F),f=d.useMemo(()=>r?Array.isArray(r)?r.flatMap(o=>h(i[o])):h(i[r]):[],[i,r]),[$,A]=d.useState(i),[x,p]=d.useState(!1);i!==$&&(A(i),p(!1));let V=d.useMemo(()=>C(x?[]:f),[x,f]),S=d.useRef(m),[g,E]=d.useState(m),b=d.useRef(m),B=()=>{if(!R)return;y(!1);let o=n||l||S.current;M(o,b.current)||(b.current=o,E(o))},[R,y]=d.useState(!1);return d.useEffect(B),{realtimeValidation:u||V||n||l||m,displayValidation:v==="native"?u||V||g:u||V||n||l||g,updateValidation(o){v==="aria"&&!M(g,o)?E(o):S.current=o},resetValidation(){let o=m;M(o,b.current)||(b.current=o,E(o)),v==="native"&&y(!1),p(!0)},commitValidation(){v==="native"&&y(!0),p(!0)}}}function h(a){return a?Array.isArray(a)?a:[a]:[]}function _(a,e){if(typeof a=="function"){let t=a(e);if(t&&typeof t!="boolean")return h(t)}return[]}function C(a){return a.length?{isInvalid:!0,validationErrors:a,validationDetails:P}:null}function M(a,e){return a===e?!0:!!a&&!!e&&a.isInvalid===e.isInvalid&&a.validationErrors.length===e.validationErrors.length&&a.validationErrors.every((t,r)=>t===e.validationErrors[r])&&Object.entries(a.validationDetails).every(([t,r])=>e.validationDetails[t]===r)}function W(a,e,t){let{validationBehavior:r,focus:s}=a;U(()=>{if(r==="native"&&t?.current&&!t.current.disabled){let n=e.realtimeValidation.isInvalid?e.realtimeValidation.validationErrors.join(" ")||"Invalid value.":"";t.current.setCustomValidity(n),t.current.hasAttribute("title")||(t.current.title=""),e.realtimeValidation.isInvalid||e.updateValidation(q(t.current))}});let l=d.useRef(!1),c=I(()=>{l.current||e.resetValidation()}),v=I(n=>{var i;e.displayValidation.isInvalid||e.commitValidation();let f=t==null||(i=t.current)===null||i===void 0?void 0:i.form;if(!n.defaultPrevented&&t&&f&&z(f)===t.current){var $;s?s():($=t.current)===null||$===void 0||$.focus(),j("keyboard")}n.preventDefault()}),u=I(()=>{e.commitValidation()});d.useEffect(()=>{let n=t?.current;if(!n)return;let i=n.form,f=i?.reset;return i&&(i.reset=()=>{l.current=!window.event||window.event.type==="message"&&window.event.target instanceof MessagePort,f?.call(i),l.current=!1}),n.addEventListener("invalid",v),n.addEventListener("change",u),i?.addEventListener("reset",c),()=>{n.removeEventListener("invalid",v),n.removeEventListener("change",u),i?.removeEventListener("reset",c),i&&(i.reset=f)}},[t,v,u,c,r])}function k(a){let e=a.validity;return{badInput:e.badInput,customError:e.customError,patternMismatch:e.patternMismatch,rangeOverflow:e.rangeOverflow,rangeUnderflow:e.rangeUnderflow,stepMismatch:e.stepMismatch,tooLong:e.tooLong,tooShort:e.tooShort,typeMismatch:e.typeMismatch,valueMissing:e.valueMissing,valid:e.valid}}function q(a){return{isInvalid:!a.validity.valid,validationDetails:k(a),validationErrors:a.validationMessage?[a.validationMessage]:[]}}function z(a){for(let e=0;e<a.elements.length;e++){let t=a.elements[e];if(!t.validity.valid)return t}return null}export{K as $,J as a,W as b,L as c};
//# sourceMappingURL=useFormValidation-C2appLSi.js.map
